# 🏎️ ESP32 电机控制实战：L298N 驱动与平滑换向

欢迎来到 **轻松易学嵌入式** 频道！本实验将带你进入电机控制的世界。我们将使用 ESP32 配合经典的 **L298N H桥驱动模块**，实现对直流电机的精准调速、刹车以及带安全机制的平滑换向控制。

📺 **配套视频教程**:

[![ESP32 L298N 电机控制实战](https://img.youtube.com/vi/404cDSadeVM/maxresdefault.jpg)](https://www.youtube.com/watch?v=404cDSadeVM)

*点击上方图片直接跳转到 YouTube 观看*

---

## 🛠️ 实验目标：构建可靠的电机驱动系统

直流电机控制不仅仅是让它转起来，更重要的是如何安全、丝滑地控制。本实验通过摇杆模拟油门，通过按键模拟排挡，展示了一个完整的电机控制逻辑。

### 1. 🔍 核心技术点

*   **H桥驱动原理 (L298N)**: 
    通过 IN1 和 IN2 的逻辑组合控制电机转向，通过 ENA 引脚的 PWM 信号控制转速。
*   **平滑换向逻辑 (Soft Direction Toggle)**: 
    为了保护电机和驱动器，程序在切换方向前会执行一个**强制平滑减速**过程。防止电机在高速旋转时瞬间反转产生巨大的电流冲击（反电动势）。
*   **多区摇杆控制**:
    *   **油门区**: 线性映射转速。
    *   **死区 (Dead Zone)**: 防止传感器轻微漂移导致电机微颤。
    *   **刹车区 (Braking)**: 将 IN1/IN2 同时置低，实现电磁抱死，缩短惯性距离。
*   **LEDC 模块适配**: 
    代码完全兼容 **Arduino-ESP32 v3.0+** 的新版 PWM API。

### 2. ⚡ 硬件连接说明

| 组件 | 功能 | ESP32 引脚 (GPIO) |
| :--- | :--- | :--- |
| **L298N IN1** | 方向控制 A | GPIO 20 |
| **L298N IN2** | 方向控制 B | GPIO 21 |
| **L298N ENA** | 速度控制 (PWM) | GPIO 5 |
| **换向按键** | 切换正反转 | GPIO 10 (内置上拉) |
| **游戏摇杆** | 油门/刹车输入 | GPIO 0 (ADC) |

---

## 🚀 实验步骤

1.  **硬件接线**: 
    *   按照表格连接控制线。
    *   **重要**：L298N 的 GND 必须与 ESP32 的 GND 共地。
    *   电机需要外部供电（如 7.4V 或 12V 电池），不要尝试从 ESP32 的 3.3V 引脚取电。
2.  **上传代码**: 使用 Arduino IDE 将 `L005_L298N.ino` 上传。
3.  **操控测试**: 
    *   向前推摇杆，电机加速。
    *   向后拉摇杆，电机执行“电子刹车”。
    *   按下按键，观察电机如何先减速停止，再反向启动。

---

## ⚠️ 安全警告

1.  **电流保护**：L298N 效率较低且发热量大，实验时请摸一下散热片，避免过热。
2.  **共地要求**：所有模块的 GND 必须互连，否则控制信号会失效。
3.  **电机电压**：确保外部电源电压符合你的电机规格。

---

## 🌟 关注我们

如果您觉得这个教程对您有帮助，请订阅我们的频道，获取更多实战干货：
👉 **[YouTube: 轻松易学嵌入式](https://www.youtube.com/@%E8%BD%BB%E6%9D%BE%E6%98%93%E5%AD%A6%E5%B5%8C%E5%85%A5%E5%BC%8F)**

让我们一起轻松玩转嵌入式！
