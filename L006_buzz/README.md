# 🎵 ESP32 蜂鸣器音乐实战：LEDC 频率动态切换

欢迎来到 **轻松易学嵌入式** 频道！本实验将带你进入嵌入式音频的逻辑世界。我们将使用 ESP32 的 LEDC 模块驱动无源蜂鸣器，通过动态改变 PWM 频率来播放经典旋律《小星星》。

📺 **配套视频教程**:

[![ESP32 蜂鸣器音乐实战](https://img.youtube.com/vi/SMSCVz9iezQ/maxresdefault.jpg)](https://www.youtube.com/watch?v=SMSCVz9iezQ)

*点击上方图片直接跳转到 YouTube 观看*

---

## 🛠️ 实验目标：用代码编写旋律

本实验的核心挑战在于如何将音乐理论（音高与节拍）转化为硬件参数。

### 1. 🔍 核心技术点

*   **频率即音高 (Frequency = Pitch)**: 
    无源蜂鸣器不像有源蜂鸣器那样通电即响。它需要特定频率的方波信号。频率越高，声音越尖锐（高音）；频率越低，声音越低沉。
*   **LEDC 频率动态切换**: 
    使用 `ledcChangeFrequency()` 函数在程序运行时实时更改 PWM 频率。这是让蜂鸣器“唱歌”的关键。
*   **API 兼容性 (v3.0+)**: 
    代码完全适配 **Arduino-ESP32 v3.0+** 的最新 `ledcAttach` 接口。
*   **乐谱数字化**: 
    通过定义 `melody[]`（频率数组）和 `noteDurations[]`（节拍数组），将简谱转化为单片机可处理的数据结构。

### 2. ⚡ 硬件连接说明

| 组件 | 功能 | ESP32 引脚 (GPIO) |
| :--- | :--- | :--- |
| **无源蜂鸣器** +针脚 | 信号输入 | GPIO 5 |
| **无源蜂鸣器** -针脚 | 接地 | GND |

*注意：本实验必须使用**无源蜂鸣器**（Passive Buzzer）。有源蜂鸣器只能发出单一频率的鸣叫，无法奏乐。*

---

## 🚀 实验步骤

1.  **硬件连线**: 将无源蜂鸣器连接至 GPIO 5。
2.  **上传代码**: 使用 Arduino IDE 将 `L6_buzz.ino` 上传至开发板。
3.  **聆听旋律**: 上传成功后，蜂鸣器将循环播放《小星星》。
4.  **进阶尝试**: 修改 `playSong()` 函数中的音符时长比例（如 `1.30`），可以改变乐曲的节奏快慢。

---

## 🏗️ 乐理解析

*   **128 对应 50% 占空比**: 我们在 `ledcWrite(buzzerPin, 128)` 中使用 8 位分辨率（0-255）的一半，这是为了让方波达到最大的有效功率，获得最清晰的音质。
*   **0 占空比实现停顿**: 音符之间需要短暂的 `ledcWrite(buzzerPin, 0)`，否则音符会粘连在一起，听起来不够清晰。

---

## 🌟 关注我们

如果您觉得这个教程对您有帮助，请订阅我们的频道，获取更多实战干货：
👉 **[YouTube: 轻松易学嵌入式](https://www.youtube.com/@%E8%BD%BB%E6%9D%BE%E6%98%93%E5%AD%A6%E5%B5%8C%E5%85%A5%E5%BC%8F)**

让我们一起轻松玩转嵌入式！
