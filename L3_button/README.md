# 🔘 ESP32 零基础通关：按键检测与软件消抖 (GPIO 下集)

欢迎来到 **轻松易学嵌入式** 频道！本实验是 GPIO 系列的进阶篇，重点解决电子制作中最常见的两个问题：**如何捕捉按键瞬间（边缘检测）** 以及 **如何消除机械抖动（Debouncing）**。

📺 **配套视频教程**:
*(请在频道中搜索：零基础ESP32实战：精通数字输入输出 下集)*

---

## 🛠️ 实验目标：从“电平”到“事件”

在上一节 (L2) 中，我们学会了如何读取引脚的高低电平。但在实际项目中，我们往往需要的是“按一下切换状态”，而不是“一直按着才有动作”。

### 1. 🔍 核心技术：边缘检测 (Edge Detection)
*   **上升沿 (Rising Edge)**: 引脚电平从 LOW 变为 HIGH 的瞬间。
*   **状态记忆**: 代码中使用 `lastInputState` 变量记录上一次的状态，通过对比“现在”和“过去”，锁定发生的瞬间。

### 2. ⚡ 软件消抖 (Software Debouncing)
按键是机械结构，按下时会产生几毫秒的杂波（抖动）。如果不处理，程序会误以为你按了很多次。
*   **解决方法**: 在检测到第一次触发后，使用 `delay(50)` 强制锁定一小段时间，跳过杂波期。

---

## 🚀 实验步骤

1.  **电路连接**: GPIO 0 连接按键的一端，另一端接 GND（因为使用了 `INPUT_PULLUP`）。
2.  **上传代码**: 将 `L3_button.ino` 上传至 ESP32。
3.  **观察 LED**: 按下按键，LED 应该在松开或按下的瞬间（取决于逻辑）完美切换状态，不会出现乱闪。
4.  **串口统计**: 打开串口监视器（`115200`），观察每 2 秒统计一次的按键次数。

---

## 📊 状态机逻辑

```cpp
if (lastInputState == LOW && currentInputState == HIGH) {
    // 捕获到动作！
    delay(50); // 消抖
    // 执行逻辑...
}
```

---

## 🌟 关注我们

如果您觉得这个教程对您有帮助，请订阅我们的频道：
👉 **[YouTube: 轻松易学嵌入式](https://www.youtube.com/@easymcu)**

让我们一起轻松玩转嵌入式！
