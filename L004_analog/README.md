# 🎛️ ESP32 模拟量采集与 PWM 控制 (ADC & LEDC)

欢迎来到 **轻松易学嵌入式** 频道！本实验将带你掌握 ESP32 处理模拟信号的核心技能：如何精准读取模拟电压，以及如何利用 PWM（脉宽调制）技术控制外设（如 LED 亮度或电机转速）。

📺 **配套视频教程**:

[![ESP32 模拟量与 PWM 实战](https://img.youtube.com/vi/LVCTh4KSn4U/maxresdefault.jpg)](https://www.youtube.com/watch?v=LVCTh4KSn4U)

*点击上方图片直接跳转到 YouTube 观看*

---

## 🛠️ 实验目标：从模拟到数字的桥梁

在现实世界中，信号大多是连续的模拟量（如光照、声音、摇杆位置）。本实验通过读取摇杆的模拟输出，并将其转化为 PWM 信号来调节 LED 的亮度，实现了“模拟输入 -> 数字处理 -> 模拟效果输出”的完整链路。

### 1. 🔍 核心技术点

*   **ADC 衰减配置 (`analogSetAttenuation`)**: 
    ESP32 的 ADC 默认量程较窄。通过设置为 `ADC_11db`，我们可以将测量范围扩大到 **0V - 3.3V**，从而匹配大多数传感器的电压范围。
*   **LEDC 模块 (新版 API)**: 
    *注意：* 在 Arduino-ESP32 **v3.0+** 版本中，传统的 `ledcSetup` 和 `ledcAttachPin` 已被废弃。本方案采用最新的 `ledcAttach()` 接口，更加简洁高效。
*   **12 位高分辨率**:
    我们将 ADC 和 PWM 同时配置为 **12 位分辨率** (0-4095)。这样做的好处是数据可以直接透传，无需使用 `map()` 函数进行比例换算，保证了信号的丝滑同步。

### 2. ⚡ 硬件连接说明

*   **模拟输入引脚**: GPIO 0 (连接摇杆的 X 或 Y 轴)。
*   **PWM 输出引脚**: GPIO 5 (连接 LED 或示波器)。
*   **电压参考**: VCC = 3.3V, GND = 地。

---

## 🚀 实验步骤

1.  **硬件连线**: 将摇杆的模拟输出连接至 GPIO 0，将 LED 连接至 GPIO 5。
2.  **环境配置**: 确保你的 Arduino IDE 已安装最新版的 ESP32 开发板支持包 (建议 3.0.0 及以上)。
3.  **编译上传**: 将 `L4_analog.ino` 上传至开发板。
4.  **实时操控**: 推动摇杆，观察 LED 亮度的细腻变化。你可以打开**串口绘图仪**，对比摇杆数值的波动。

---

## ⚠️ 重要提示：API 版本兼容性

ESP32 的官方库在 2024 年进行了重大更新（v3.0.0）。网络上 90% 的旧代码（使用 `ledcSetup`）在最新编译器下会报错或报警告。
**本代码已针对最新版本进行适配优化**，请放心食用。

---

## 🌟 关注我们

如果您觉得这个教程对您有帮助，请订阅我们的频道，获取更多实战干货：
👉 **[YouTube: 轻松易学嵌入式](https://www.youtube.com/@%E8%BD%BB%E6%9D%BE%E6%98%93%E5%AD%A6%E5%B5%8C%E5%85%A5%E5%BC%8F)**

让我们一起轻松玩转嵌入式！
